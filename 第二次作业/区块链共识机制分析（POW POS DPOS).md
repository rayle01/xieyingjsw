### 区块链共识机制分析（POW POS DPOS)

POW  POS DPOS这类共识机制的核心是，每做一次操作，你需要证明你付出了一定代价（或者你拥有某些价值），然后如果判断是事实的话，会受到相应的奖励，否则可能会收到惩罚。既然需要付出代价，哪就肯定会有人作弊，也就是再没有付出代价的情况下去作弊证明自己付出了代价，所以，在付出代价之后，你需要给出一个证明，证明你确实付出了这个代价。

#### POW：Proof of Work，工作证明

#### **POS：Proof of Stake，股权证明** 

#### **DPOS：Delegated Proof of Stake，委任权益证明** 

POW从字面上的意思就可以理解，通过对工作量的确认来证明你付出了这个代价，以比特币中的POW共识机制为例，POW的方法是最直观也是最好理解的，哈希函数是密码学上计算难度经过反复验证的东西，所以用它来做证明是最有效不过的。每做一次操作（上传一个区块）的时候，你要证明你付出了一定的算力，你的证据就是某串你加在区块里的无意义字符串，而加上这个字符串之后，你的区块的哈希值正好小于某个数。哈希函数的特性告诉我们，你没有任何取巧的方法可以做到这一点——唯一的可能是，你真的一个一个字符串地去试了。所以，我们知道你确实付出了很多的代价才能给出这么一个字符串。

POW的缺陷在于，除了大量消耗能源（资源）以外，他的价值体现是通过外部输入的。他的安全性不直接跟使用者相关，而是通过矿工这个外部的媒介相关。

POS从字面上也可以理解，当你每做一个操作的时候，不需要你证明你付出了多少代价，而要证明你拥有多少股权，正因为你拥有了股权，如果你作弊损害了这个系统的安全性的时候，你的股权会贬值，也就是让你付出了相应的代价。这样就导致对资源的消耗可以忽略不记，实际上连挖矿奖励都可以不需要。但是POS本身也有个缺陷，股权越多的人，作弊付出的代价越大，股权越少或者没有股权的人，他们基本没有代价可付，所以一些恶意行为对于他们是有益的。Nothing-at-stake attack（无利益攻击） 由此产生。

DPOS是POS的一个变种，实际上是解决Nothing-at-stake attack（无利益攻击）的另一种方式——没资产的滚蛋，只有有资产才能参加共识。所以，DPOS的本质实际上是一个中心化的共识机制。

#### POW POS 流程对比

![img](https://upload-images.jianshu.io/upload_images/4582835-fd576d13affa6cce..png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700)

#### POS DPOS原理对比

![img](https://upload-images.jianshu.io/upload_images/4582835-390fadfc8d654a58..png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700) 

#### 几种共识机制对比

- PoW采用简单粗暴但极为有效的方式，通过节点首先自证其资质后才进行广播的方式，大幅度减少了网络间的通讯压力，但与之带来的问题则在于自证资质的计算资源消耗极大。
- PoS采用与传统分布式一致性验证类似的机制，通过代币数量（或存储容量等指标）作为权重依据，使用某种分布式算法选举出每次的检查点节点。这种机制的好处在于没有消耗计算资源的自证资质过程，但是带来的问题在于每次选举时在大量节点的网络中对网络压力极大。
- DPoS作为PoS的变形，通过缩小选举节点的数量以减少网络压力，是一种典型的分治策略：将所有节点分为领导者与跟随者，只有领导者之间达成共识后才会通知跟随者。该机制能够在不增加计算资源的前提下有效减少网络压力，在优秀的软件实现中将会具有较强的应用价值。
- DAG则采用异步机制替代链式检查点的同步策略，在优秀的软件实现中如果能够有效控制网络风暴带来的带宽需求指数增加，其不失为一种对最终一致性场景有较好应用前景的算法。但是DAG的局限性也极为明显，其体系无法被利用在需要进行同步操作或一致性要求较高的操作中（例如支付结算等）



![img](https://upload-images.jianshu.io/upload_images/4582835-f71d13e7e6f00f75.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700) 

 

参考文章：https://www.jianshu.com/p/d3f94bc53c48



#### 